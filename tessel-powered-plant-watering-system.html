<!DOCTYPE html> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <link rel="alternate" type="application/rss+xml" title="Max Ogden Blogotronz (RSS 2.0)" href="http://maxogden.com/rss.xml">
  <title>Max Ogden Blogotronz</title> 
  
  <link href="styles/styles.css" media="screen" rel="stylesheet" type="text/css">
  <link href="styles/rainbow.github.css" media="screen" rel="stylesheet" type="text/css">

  <!-- libraries --> 
  <script src="script/jquery-1.6.1.min.js"></script>
  <script src="script/underscore.js"></script>
  <script src="script/d3.min.js"></script>
  <script src="script/voronoi.min.js"></script>
  <script src="script/rainbow.min.js"></script>
  <script src="script/rainbow.generic.js"></script>
  <script src="script/rainbow.javascript.js"></script>
  <script src="script/rainbow.css.js"></script>
  <script src="script/helpers.js"></script>
  
  <script src="script/application.js"></script>

</head>
<body> 
  <div id="container">
    <div class="header">
      <div class="title"><a href="https://github.com/maxogden" rel="me">Max Ogden</a> | Open Web programmer</div>
      <div class="subtitle"></div>
      <!-- THANKS, MICHAEL BOSTOCK! YOU RULE -->
      <div id="voronoi">
      </div>
      <div class="channel"></div>
      <div id="navigation">
        <div class="toggle home">
          <div class="navitem">
            <span rel="emojilock" style="letter-spacing: 3px;">📍🌍💩👼💊🍃🍷🍃🐊👅⛄️🎵🔋👊🐫🍁🐜🎂🐇🐣🐾👛📚👇🍟🐝🎲😭🎈🎊🙏🐜</span>
          </div>
        </div>
        <div class="toggle home">
          <div class="navitem">
            <a href="index.html">blog</a>
          </div>
        </div>
        <div class="toggle home">
          <div class="navitem">
            <a href="videos.html">media</a>
          </div>
        </div>
        <div class="toggle home">
          <div class="navitem">
            <a href="contact.html">contact</a>
          </div>
        </div>
      </div>
    </div>
    
    <div id="wrapper">
      <div id="browser">
        <div id="documents"><a class="load-document" href="node-distributed-systems.html">
  <div class="document" id="node-distributed-systems">
    <div class="published" data-published="2016-05-06T06:32:56.584Z">May 2016</div>
    <div class="title">Getting Started With Node For Distributed Systems</div>
    <div class="teaser">Where to get started with streams and peer to peer</div>
  </div>
</a>

<a class="load-document" href="iotjs-and-jerryscript.html">
  <div class="document" id="iotjs-and-jerryscript">
    <div class="published" data-published="2015-07-24T06:32:56.584Z">July 2015</div>
    <div class="title">What's the deal with iot.js and JerryScript</div>
    <div class="teaser">Node.js will soon be running on tiny low power chips</div>
  </div>
</a>

<a class="load-document" href="electron-fundamentals.html">
  <div class="document" id="electron-fundamentals">
    <div class="published" data-published="2015-07-23T06:32:56.584Z">July 2015</div>
    <div class="title">Electron Fundamentals</div>
    <div class="teaser">A quick intro to Electron, a desktop application runtime</div>
  </div>
</a>

<a class="load-document" href="hd-live-streaming-cats.html">
  <div class="document" id="hd-live-streaming-cats">
    <div class="published" data-published="2015-05-26T06:32:56.584Z">May 2015</div>
    <div class="title">HD Live Streaming Cats to YouTube with the Raspberry Pi Camera</div>
    <div class="teaser">A how to guide</div>
  </div>
</a>

<a class="load-document" href="interdisciplinary-open-source-events.html">
  <div class="document" id="interdisciplinary-open-source-events">
    <div class="published" data-published="2015-05-10T06:32:56.584Z">May 2015</div>
    <div class="title">Interdisciplinary Open Source Community Conferences</div>
    <div class="teaser">A list of community organized events</div>
  </div>
</a>

<a class="load-document" href="https-wildcard-nginx-setup.html">
  <div class="document" id="https-wildcard-nginx-setup">
    <div class="published" data-published="2015-04-30T06:32:56.584Z">April 2015</div>
    <div class="title">Setting up HTTPS with a wildcard certificate and Nginx</div>
    <div class="teaser">How I set up HTTPS with Nginx</div>
  </div>
</a>

<a class="load-document" href="a-month-of-modules.html">
  <div class="document" id="a-month-of-modules">
    <div class="published" data-published="2015-04-30T03:32:56.584Z">April 2015</div>
    <div class="title">A Month of Modules</div>
    <div class="teaser">Modules Mafintosh and I wrote this month</div>
  </div>
</a>

<a class="load-document" href="tessel-powered-plant-watering-system.html">
  <div class="document active" id="tessel-powered-plant-watering-system">
    <div class="published" data-published="2015-02-25T03:32:56.584Z">February 2015</div>
    <div class="title">Tessel Powered Plant Watering System</div>
    <div class="teaser">Make an HTTP accessible water pump</div>
  </div>
</a>

<a class="load-document" href="portland-fiber.html">
  <div class="document" id="portland-fiber">
    <div class="published" data-published="2015-02-01T03:32:56.584Z">January 2015</div>
    <div class="title">Portland Fiber Internet</div>
    <div class="teaser">Review of 1Gb fiber from CenturyLink</div>
  </div>
</a>

<a class="load-document" href="node-repl.html">
  <div class="document" id="node-repl">
    <div class="published" data-published="2015-01-24T23:04:02.791Z">January 2015</div>
    <div class="title">node-repl</div>
    <div class="teaser">An interactive console for node</div>
  </div>
</a>

<a class="load-document" href="nested-dependencies.html">
  <div class="document" id="nested-dependencies">
    <div class="published" data-published="2015-01-13T22:24:35.821Z">January 2015</div>
    <div class="title">Nested Dependencies</div>
    <div class="teaser">Insight into why node_modules works the way it does</div>
  </div>
</a>

<a class="load-document" href="node-packaged-modules.html">
  <div class="document" id="node-packaged-modules">
    <div class="published" data-published="2013-07-08T20:48:11.493Z">July 2013</div>
    <div class="title">Node Packaged Modules</div>
    <div class="teaser">Bringing NPM modules to the web</div>
  </div>
</a>

<a class="load-document" href="kindleberry-wireless.html">
  <div class="document" id="kindleberry-wireless">
    <div class="published" data-published="2013-03-24T20:48:11.493Z">March 2013</div>
    <div class="title">Kindleberry Wireless</div>
    <div class="teaser">A Portable Outdoor Hackstation</div>
  </div>
</a>

<a class="load-document" href="bringing-minecraft-style-games-to-the-open-web.html">
  <div class="document" id="bringing-minecraft-style-games-to-the-open-web">
    <div class="published" data-published="2013-01-25T20:48:11.493Z">January 2013</div>
    <div class="title">Bringing Minecraft-style games to the Open Web</div>
    <div class="teaser">A status report from the one month old voxel.js project</div>
  </div>
</a>

<a class="load-document" href="a-proposal-for-streaming-xhr.html">
  <div class="document" id="a-proposal-for-streaming-xhr">
    <div class="published" data-published="2012-11-20T20:48:11.493Z">November 2012</div>
    <div class="title">A Proposal For Streaming XHR</div>
    <div class="teaser">XHR2 isn't stream friendly. Lets explore why and propose a solution!</div>
  </div>
</a>

<a class="load-document" href="scraping-with-node.html">
  <div class="document" id="scraping-with-node">
    <div class="published" data-published="2012-10-24T20:48:11.493Z">October 2012</div>
    <div class="title">Scraping With Node</div>
    <div class="teaser">Useful modules and a tutorial on how to parse HTML with node.js</div>
  </div>
</a>

<a class="load-document" href="building-webview-applications.html">
  <div class="document" id="building-webview-applications">
    <div class="published" data-published="2012-10-15T20:48:11.493Z">October 2012</div>
    <div class="title">Building WebView Applications</div>
    <div class="teaser">Things I learned while building @gather</div>
  </div>
</a>

<a class="load-document" href="fast-webview-applications.html">
  <div class="document" id="fast-webview-applications">
    <div class="published" data-published="2012-05-31T20:48:11.493Z">May 2012</div>
    <div class="title">Fast WebView Applications</div>
    <div class="teaser">How to make web apps feel fast and responsive</div>
  </div>
</a>

<a class="load-document" href="node-streams.html">
  <div class="document" id="node-streams">
    <div class="published" data-published="2012-04-17T23:52:20.241Z">April 2012</div>
    <div class="title">Node Streams: How do they work?</div>
    <div class="teaser">Description of and notes on the node.js Stream API</div>
  </div>
</a>

<a class="load-document" href="gut-hosted-open-data-filets.html">
  <div class="document" id="gut-hosted-open-data-filets">
    <div class="published" data-published="2011-12-02T20:36:31.424Z">December 2011</div>
    <div class="title">Gut: Hosted Open Data Filet Knives</div>
    <div class="teaser">HTTP Unix pipes for Open Data</div>
  </div>
</a>

<a class="load-document" href="little-coders.html">
  <div class="document" id="little-coders">
    <div class="published" data-published="2011-07-17T02:56:48.555Z">July 2011</div>
    <div class="title">Little Coders</div>
    <div class="teaser">Elementary school programming</div>
  </div>
</a></div>
      </div>
      <div id="document"><div id="header"><h1 class="title">Tessel Powered Plant Watering System</h1></div>

<p>Make a water pump that can be turned on and off over HTTP using only JavaScript.</p>
<p><strong>Warning</strong> Do not try this at home without the help of an electronics expert. Solid state relays switch high voltage and can cause bodily harm if used improperly.</p>
<p>I have been looking for a way to do hobby electronics projects using JavaScript running on microcontrollers. You can control an Arduino remotely from a laptop over USB with libraries like <a href="https://www.npmjs.com/package/johnny-five">johnny-five</a>, but you can&#39;t keep your code running after you close your laptop since the Arduino can&#39;t run JavaScript.</p>
<p>The <a href="https://tessel.io/">Tessel</a> is a microcontroller that runs Node code <strong>on the board</strong>. The team at Tessel wrote a <a href="https://github.com/tessel/colony-compiler">JS to Lua compiler</a> and then they run Lua directly on the Tessel hardware. It&#39;s not the fastest thing in the world, but it opens up most of npm to run on a wi-fi enabled, USB powered microcontroller the size of an Arduino.</p>
<p>For this project I used four components. It takes about an hour to put together:</p>
<ul>
<li><a href="https://shop.tessel.io/">Tessel Microcontroller</a></li>
<li><a href="http://www.amazon.com/DC-AC-Solid-State-Relay-Heatsink/dp/B005K2IXHU/ref=sr_1_4?ie=UTF8&qid=1424888528&sr=8-4&keywords=Lightobject">Fotek SSR-25DA Solid State Relay</a></li>
<li><a href="http://www.amazon.com/AquaTop-NP-80-Aquatop-Aquarium-Submersible/dp/B00798FYR0">AquaTop NP-80 Submersible Pump</a></li>
<li><a href="http://www.amazon.com/Lutron-TT-300NLH-WH-Credenza-Dimmer-White/dp/B0000DI241/ref=sr_1_1?ie=UTF8&qid=1424888624&sr=8-1&keywords=dimmer+light">Lutron TT-300NLH-WH Lamp Dimmer</a></li>
</ul>
<p>I would also recommend using a junction box/electronics enclosure for housing the SSR along the lines of <a href="http://www.amazon.com/Estone%C2%AE-85x58x33mm-Waterproof-Electronic-Enclosure/dp/B00M1HL2UM/ref=sr_1_2?s=hi&amp;ie=UTF8&amp;qid=1424891818&amp;sr=1-2&amp;keywords=estone+box#productDetails">this one</a>.</p>
<p>The key is the solid state relay. For background on how these works check out <a href="http://www.scienceprog.com/considering-solid-state-relays-ssr-for-your-projects/">this excellent article</a>, but the short version is that they let you use a small voltage (3.3V or 5V such as those available in &quot;digital out&quot; pins in microcontrollers) to turn on and off high voltage circuits such as 110V or 220V (wall outlets).</p>
<p>Instead of using an SSR directly as I did you could also purchase a <a href="http://www.powerswitchtail.com/Pages/default.aspx">PowerSwitch Tail</a>, which is a pre-made, safely housed relay enclosure that comes to you already built.</p>
<p><a href="media/tessel-components-large.png"><img src="media/tessel-components.png" alt="components"></a></p>
<p>To build the &#39;circuit&#39;, I simply cut the dimmer slider portion off of the Lamp Dimmer, stripped the ends off of the wires, and connected them to the SSR instead. Where there used to be a dimmer slider the circuit there is now the SSR.</p>
<p>The flow of electricity is roughly: Wall -&gt; Dimmer -&gt; SSR -&gt; Pump. The tessel is connected to the SSR and can turn it on and off at will.</p>
<p><strong>Again, I can&#39;t stress enough that you should really not try this on your own unless you have someone who is experienced with Solid State Relays and 110V/220V electricity.</strong></p>
<p>Here&#39;s a <a href="http://youtu.be/sgU3McOF-l8">video of the system in action</a>:</p>
<iframe width="640" height="360" src="https://www.youtube.com/embed/sgU3McOF-l8?rel=0" frameborder="0" allowfullscreen=""></iframe>

<p>The tessel is running a small HTTP server written in Node that turns the G3 GPIO pin on or off. When it is on it outputs 3.3V to the SSR, which tells the SSR to turn on voltage, which turns on the pump.</p>
<pre><code class="lang-js">var tessel = require(&#39;tessel&#39;)
var http = require(&#39;http&#39;)

var pin = tessel.port[&#39;GPIO&#39;].pin[&#39;G3&#39;]

var server = http.createServer(function (req, res) {
  console.log(req.url)
  if (req.url === &#39;/on&#39;) return on(req, res)
  if (req.url === &#39;/off&#39;) return off(req, res)
  return res.end(&#39;&lt;a href=&quot;/on&quot;&gt;/on&lt;/a&gt; or &lt;a href=&quot;/off&quot;&gt;/off&lt;/a&gt;\n&#39;)
})

server.listen(80, function(err) {
  if (err) console.log(&#39;error!&#39; + err)
  console.log(&#39;http listening&#39;)
})

function on (req, res) {
  console.log(&#39;turning on&#39;)
  pin.write(1)
  res.end(&#39;turned on\n&#39;)
}

function off (req, res) {
  console.log(&#39;turning off&#39;)
  pin.write(0)
  res.end(&#39;turned off\n&#39;)
}
</code></pre>
<p>Save the above code as a file called <code>server.js</code>, plug your Tessel over USB, and run <code>tessel push server.js</code> to upload the server onto your Tessel. You can run <code>tessel logs</code> to view the HTTP server logs while your tessel is connected over USB.</p>
<p>Once you have the Tessel configured to join your home Wi-Fi (using the <code>tessel wifi</code> CLI command) it will then always automatically connect a few seconds after powering up, every time. You can put it anywhere in your house, power it over USB, and it will start up it&#39;s HTTP server and be accessible over your local network.</p>
<p>You could definitely use other microcontrollers instead of the Tessel for this. I like the Tessel, however, because it is the simplest way to run Node code on hardware, and they also make add-on hardware modules that are easy to use. For example, you could use the Raspberry Pi for this project, but it would be more complicated as you would have to configure Linux. I just prefer to keep things easy!</p>
<p>Happy hacking! Questions? Open an issue <a href="https://github.com/maxogden/blog/issues">in this repository</a></p>
</div>
    </div>
  </div>  
  
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24933665-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</body> 
</html>
